# 基于 VirtualBox 的网络攻防基础环境搭建

## 实验目的

- 掌握 VirtualBox 虚拟机的安装与使用；
- 掌握 VirtualBox 的虚拟网络类型和按需配置；
- 掌握 VirtualBox 的虚拟硬盘多重加载；

## 实验环境

以下是本次实验需要使用的网络节点说明和主要软件举例：

- VirtualBox 虚拟机
- 攻击者主机（Attacker）：Kali Rolling 2109.2
- 网关（Gateway, GW）：Debian Buster
- 靶机（Victim）：From Sqli to shell / xp-sp3 / Kali

## 实验要求

- 虚拟硬盘配置成多重加载，效果如下图所示；

![img](https://c4pr1c3.github.io/cuc-ns/chap0x01/attach/chap0x01/media/vb-multi-attach.png)

- 搭建满足如下拓扑图所示的虚拟机网络拓扑；

![img](https://c4pr1c3.github.io/cuc-ns/chap0x01/attach/chap0x01/media/vb-exp-layout.png)

> 根据实验宿主机的性能条件，可以适度精简靶机数量

- 完成以下网络连通性测试
  - [x] 靶机可以直接访问攻击者主机
  - [x] 攻击者主机无法直接访问靶机
  - [x] 网关可以直接访问攻击者主机和靶机
  - [x] 靶机的所有对外上下行流量必须经过网关
  - [x] 所有节点均可以访问互联网

## 实验报告

 ### 配置虚拟机

- 多重加载

  ![kali多重加载](img/kali多重加载.PNG)

- 创建虚拟机并配置网络

  ![创建虚拟机](img/创建虚拟机.PNG)

  ![创建虚拟机2](img/创建虚拟机2.PNG)

  ![创建虚拟机3](img/创建虚拟机3.PNG)

  ![创建虚拟机4](img/创建虚拟机4.PNG)

  ![创建虚拟机5](img/创建虚拟机5.PNG)

  ![创建虚拟机6](img/创建虚拟机6.PNG)

- gateway界面名称、DHCP服务器地址

  ![gateway（host only）](img/gateway（host only）.PNG)

  ![DHCP](img/DHCP.PNG)

  #### 各虚拟机IP地址

  | 虚拟机         | IP             |
  | -------------- | -------------- |
  | victim-kali    | 172.16.111.100 |
  | victim-debian  | 172.16.222.127 |
  | victim-xp1     | 172.16.111.144 |
  | victim-xp2     | 172.16.222.139 |
  | gateway-debian | 192.168.79.10  |
  | attacker-kali  | 10.0.2.15      |

### 完成以下网络连通性测试

- 靶机可以直接访问攻击者主机

  ![靶机可以直接访问攻击者主机1](img/靶机可以直接访问攻击者主机1.PNG)

  ![靶机可以直接访问攻击者主机2](img/靶机可以直接访问攻击者主机2.PNG)

  ![靶机可以直接访问攻击者主机3](img/靶机可以直接访问攻击者主机3.PNG)

  ![靶机可以直接访问攻击者主机4](img/靶机可以直接访问攻击者主机4.PNG)

- 攻击者主机无法直接访问靶机

  ![攻击者主机无法直接访问靶机](img/攻击者主机无法直接访问靶机.PNG)

- 网关可以直接访问攻击者主机和靶机

  ![网关可以直接访问攻击者主机和靶机3](img/网关可以直接访问攻击者主机和靶机3.PNG)

  ![网关可以直接访问攻击者主机和靶机4](img/网关可以直接访问攻击者主机和靶机4.PNG)

  ![网关可以直接访问攻击者主机和靶机5](img/网关可以直接访问攻击者主机和靶机5.PNG)

  ![网关可以直接访问攻击者主机和靶机2](img/网关可以直接访问攻击者主机和靶机2.PNG)

  ![网关可以直接访问攻击者主机和靶机1](img/网关可以直接访问攻击者主机和靶机1.PNG)

- 靶机的所有对外上下行流量必须经过网关

  ![wireshark](img/wireshark.png)

- 所有节点均可以访问互联网

  victim-kali

  ![所有节点均可以访问互联网2](img/所有节点均可以访问互联网2.PNG)

  victim-debian

  ![所有节点均可以访问互联网5](img/所有节点均可以访问互联网5.PNG)

  victim-xp1

  ![所有节点均可以访问互联网6](img/所有节点均可以访问互联网6.PNG)

  vixtim-xp2

  ![所有节点均可以访问互联网3](img/所有节点均可以访问互联网3.PNG)

  attacker-kali

  ![所有节点均可以访问互联网4](img/所有节点均可以访问互联网4.PNG)

  gateway-debian

  ![所有节点均可以访问互联网1](img/所有节点均可以访问互联网1.PNG)

### 参考资料

[1.12 第一章课后实验详解](https://www.bilibili.com/video/BV1CL41147vX?p=12)
